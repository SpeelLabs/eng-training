# モジュール4: データベース連携

モジュール 4 では、パート 1 で作成したインメモリーベースのブログアプリケーションを、MySQL データベースを使用したデータ永続化対応のアプリケーションに発展させます。このモジュールでは、JDBC による基本的なデータベース操作から始めて、段階的に本格的な永続化機能を実装していきます。

アプリケーションのデータが再起動後も保持されるようになり、より実用的なWebアプリケーションの基盤を構築することが目標です。

### 概要と目的

#### 作成するアプリケーションの構成

このモジュールでは、以下の機能をデータベース対応に変更します。

1. **データベース設計と接続**:
   * ブログアプリケーション用のデータベース設計
   * JDBC による MySQL への接続設定
2. **投稿データのデータベース保存**:
   * posts テーブルの作成と設計
   * 基本的な CRUD 操作の実装
3. **データベース操作の基礎**:
   * PreparedStatement による安全なSQL実行
   * 接続管理とリソース解放
4. **既存機能のデータベース対応**:
   * 投稿一覧表示のデータベース対応
   * 投稿詳細表示のデータベース対応
   * 新規投稿機能のデータベース対応

#### このモジュールで達成すること

1. MySQL データベースの基本設計と接続方法の習得
2. JDBC を使用した基本的なデータベース操作の実装
3. 投稿データの永続化機能の実装
4. PreparedStatement による安全なSQL実行方法の習得
5. データベース接続の適切な管理方法の理解
6. 既存のインメモリーアプリケーションのデータベース対応

#### このモジュールで使用する技術

<table><thead><tr><th width="200.3636474609375">技術</th><th>説明</th></tr></thead><tbody><tr><td><strong>MySQL</strong></td><td>リレーショナルデータベース管理システム</td></tr><tr><td><strong>JDBC</strong></td><td>Java からデータベースにアクセスするための API</td></tr><tr><td><strong>PreparedStatement</strong></td><td>SQL インジェクション対策を含む安全なSQL実行</td></tr><tr><td><strong>SQL</strong></td><td>データベース操作のための標準言語</td></tr><tr><td><strong>Connection 管理</strong></td><td>データベース接続の適切な管理とリソース解放</td></tr><tr><td><strong>データベース設計</strong></td><td>正規化とテーブル設計の基礎</td></tr></tbody></table>

### アウトライン

1. **データベース設計と環境構築** ブログアプリケーション用のデータベース設計を行い、必要なテーブルを作成します。MySQL データベースへの接続設定を行い、JDBC ドライバーの設定を完了させます。サンプルデータの投入と基本的な接続テストを実施します。
2. **基本的なデータベース操作の実装** JDBC を使用した基本的なデータベース操作を実装します。最初は単純な SELECT 文から始めて、INSERT、UPDATE、DELETE の各操作を段階的に実装します。PreparedStatement の使用方法と SQL インジェクション対策も学習します。
3. **投稿データの永続化実装** 投稿データをデータベースに保存する機能を実装します。Post クラスとデータベーステーブルの対応付けを行い、オブジェクトとレコードの変換方法を学習します。自動採番による ID 生成や日時データの適切な処理も実装します。
4. **投稿一覧表示のデータベース対応** パート 1 で実装した投稿一覧表示機能をデータベース対応に変更します。アプリケーションスコープではなくデータベースから投稿データを取得し、適切な順序で表示する機能を実装します。
5. **投稿詳細表示のデータベース対応** 投稿詳細表示機能をデータベース対応に変更します。ID による投稿検索をデータベースクエリで実装し、存在しない投稿への適切なエラーハンドリングも追加します。
6. **新規投稿機能のデータベース対応** 新規投稿作成機能をデータベース対応に変更します。フォームから送信された投稿データをデータベースに保存し、投稿後のリダイレクト処理を実装します。投稿 ID の自動生成と投稿日時の自動設定も含めます。
7. **接続管理とエラーハンドリング** データベース接続の適切な管理方法を学習します。try-with-resources を使用したリソース管理、SQLException の適切な処理、接続プールの基本概念について理解を深めます。
8. **次のステップと発展への準備** モジュール 4 の完了により、基本的なデータベース連携が実現されます。次のモジュール 5 では DAO パターンの導入により、さらに構造化されたアプリケーション設計を学習します。また、発展モジュールでの高度なデータベース操作への準備も行います。

### 技術的な進歩

パート1からモジュール4への主な技術的進歩は以下の通りです：

#### データ永続化の実現

* **パート1**: メモリ内でのデータ管理（再起動時にデータ消失）
* **モジュール4**: データベースによる永続的なデータ保存

#### データアクセス方法の変更

* **パート1**: List\<Post> によるインメモリー管理
* **モジュール4**: SQL クエリによるデータベースアクセス

#### スケーラビリティの向上

* **パート1**: メモリ容量に制限される小規模データ
* **モジュール4**: データベースによる大容量データ対応

#### データ整合性の確保

* **パート1**: アプリケーション再起動時のデータ消失
* **モジュール4**: 永続化によるデータ保護とバックアップ対応
